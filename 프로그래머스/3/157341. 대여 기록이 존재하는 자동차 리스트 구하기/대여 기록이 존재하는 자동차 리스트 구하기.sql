WITH DATE_CONDITION AS (
    SELECT *
     FROM CAR_RENTAL_COMPANY_RENTAL_HISTORY
     WHERE MONTH(START_DATE) = 10
)

SELECT DISTINCT(CC.CAR_ID) AS CAR_ID
FROM CAR_RENTAL_COMPANY_CAR CC
JOIN CAR_RENTAL_COMPANY_RENTAL_HISTORY CH
    ON CC.CAR_ID = CH.CAR_ID
JOIN DATE_CONDITION DC
    ON CC.CAR_ID = DC.CAR_ID

WHERE CC.CAR_TYPE = '세단'

ORDER BY CC.CAR_ID DESC